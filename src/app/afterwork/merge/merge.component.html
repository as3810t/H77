<ngb-alert [type]="errorMessage[0] == '@' ? 'success' : 'danger'" [hidden]="errorMessage == ''" (close)="errorMessage = ''">{{ errorMessage[0] == '@' ? errorMessage.slice(1) : errorMessage }}</ngb-alert>
<div class="input-group">
	<span class="input-group-addon" placement="right" ngbTooltip="A mérés adatait tartalmazó xlsx vagy ods fájl">Mérés fájl</span>
	<span class="form-control" name="mergeFileName" placement="bottom" ngbTooltip="{{ mergeFileName }}">{{ mergeFileName }}</span>
	<span class="input-group-btn">
		<button class="btn btn-secondary" type="button" (click)="mergeOpenFile()">Fájl megnyitása</button>
	</span>
</div>


<ng-template #importFile let-c="close" let-d="dismiss">
	<div class="modal-header">
		<h4 class="modal-title">Importálás</h4>
		<button type="button" class="close" aria-label="Close" (click)="d()">
			<span aria-hidden="true">&times;</span>
		</button>
	</div>
	<div class="modal-body">
		<div class="input-group">
			<span class="input-group-addon" placement="right" ngbTooltip="A mérés adatait tartalmazó xlsx vagy odt fájl">Mérés fájlok</span>
			<span class="form-control" name="openFileNames" placement="bottom" ngbTooltip="{{ openFileNames.length + ' fájl' }}">{{ openFileNames.length }} fájl</span>
		</div>

		<div class="container">
			<div class="row"><div class="col"><h4>Munkalapok</h4></div></div>
			<div class="row" *ngFor="let sheet of openSheet; let i = index">
				<div class="col">
					<div class="input-group">
						<span class="input-group-addon">{{ openFileNames[i] }}</span>
						<select name="openSheet{{i}}" class="form-control" [(ngModel)]="openSheet[i]">
							<option *ngFor="let s of openSheets[i]" [value]="s">{{ s }}</option>
						</select>
					</div>
				</div>
			</div>
		</div>
		<div class="container">
			<div class="row"><div class="col"><h4>Eseménylista</h4></div></div>
			<div class="row">
				<div class="col">
					<div class="input-group">
						<span class="input-group-addon" placement="right" ngbTooltip="Annak az adatsornak a sorszáma, ami elsőnek adatot tartalmaz (fejléc utáni első)">Első adatsor</span>
						<input type="number" name="openRow" class="form-control" [(ngModel)]="openRow">
					</div>
				</div>
				<div class="col">
					<div class="input-group">
						<span class="input-group-addon" placement="right" ngbTooltip="Annak az oszlopnak a betűjele, ami az adatsor azonosító számait tartalmazza">#</span>
						<input type="text" name="openID" class="form-control" [(ngModel)]="openID">
					</div>
				</div>
			</div>
		</div>
		<div class="container">
			<div class="row">
				<div class="col">
					<div class="input-group">
						<span class="input-group-addon" placement="right" ngbTooltip="Annak az oszlopnak a betűjele, ami az eseményhez rendelt billentyűt tartalmazza ">Billentyű</span>
						<input type="text" name="openKey" class="form-control" [(ngModel)]="openKey">
					</div>
				</div>
				<div class="col">
					<div class="input-group">
						<span class="input-group-addon" placement="right" ngbTooltip="Annak az oszlopnak a betűjele, ami az esemény tevét tartalmazza">Név</span>
						<input type="text" name="openName" class="form-control" [(ngModel)]="openName">
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col">
					<div class="input-group">
						<span class="input-group-addon" placement="right" ngbTooltip="Annak az oszlopnak a betűjele, ami az esemény típusát tartalmazza">Típus</span>
						<input type="text" name="openType" class="form-control" [(ngModel)]="openType">
					</div>
				</div>
				<div class="col">
					<div class="input-group">
						<span class="input-group-addon" placement="right" ngbTooltip="Annak az oszlopnak a betűjele, az esemény sorszámát tartalmazza">Sorszám</span>
						<input type="text" name="openFreq" class="form-control" [(ngModel)]="openFreq">
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col">
					<div class="input-group">
						<span class="input-group-addon" placement="right" ngbTooltip="Annak az oszlopnak a betűjele, ami az esemény bekövetkezésének idejét tartalmazza">Idő</span>
						<input type="text" name="openTime" class="form-control" [(ngModel)]="openTime">
					</div>
				</div>
				<div class="col">
					<div class="input-group">
						<span class="input-group-addon" placement="right" ngbTooltip="Annak az oszlopnak a betűjele, ami az eseményhez tartozó mérés azonosítót tartalmazza">Azonosító</span>
						<input type="text" name="openIdent" class="form-control" [(ngModel)]="openIdent">
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col">
					<div class="input-group">
						<span class="input-group-addon" placement="right" ngbTooltip="Annak a cellána a címe, ami a kísérlet hosszát tartalmazza">Kísérlet hossza</span>
						<input type="text" name="openLength" class="form-control" [(ngModel)]="openLength">
					</div>
				</div>
			</div>
		</div>

		<div class="container">
			<div class="row"><div class="col"><h4>Billentyűk</h4></div></div>
			<div class="row">
				<div class="col">
					<div class="input-group">
						<span class="input-group-addon" placement="right" ngbTooltip="Annak a munkalapnak a neve, amin az események felsorolása található">Billentyűlap</span>
						<select name="openKeyboard" class="form-control" [(ngModel)]="openKeyboard">
							<option *ngFor="let s of openSheets[0]" [value]="s">{{ s }}</option>
						</select>
					</div>
				</div>
				<div class="col">
					<div class="input-group">
						<span class="input-group-addon" placement="right" ngbTooltip="Annak az adatsornak a sorszáma, ami elsőnek adatot tartalmaz (fejléc utáni első)">Első adatsor</span>
						<input type="text" name="openKeyboardRow" class="form-control" [(ngModel)]="openKeyboardRow">
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col">
					<div class="input-group">
						<span class="input-group-addon" placement="right" ngbTooltip="Annak az oszlopnak a betűjele, ami az eseményhez rendelt billentyűt tartalmazza ">Billentyű</span>
						<input type="text" name="openKeyboardKey" class="form-control" [(ngModel)]="openKeyboardKey">
					</div>
				</div>
				<div class="col">
					<div class="input-group">
						<span class="input-group-addon" placement="right" ngbTooltip="Annak az oszlopnak a betűjele, ami az esemény tevét tartalmazza">Név</span>
						<input type="text" name="openKeyboardName" class="form-control" [(ngModel)]="openKeyboardName">
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col">
					<div class="input-group">
						<span class="input-group-addon" placement="right" ngbTooltip="Annak az oszlopnak a betűjele, ami az esemény típusát tartalmazza">Típus</span>
						<input type="text" name="openKeyboardType" class="form-control" [(ngModel)]="openKeyboardType">
					</div>
				</div>
				<div class="col">
				</div>
			</div>
		</div>
	</div>
	<div class="modal-footer">
		<button type="button" class="btn btn-secondary" (click)="d()">Mégse</button>
		<button type="button" class="btn btn-primary" (click)="c()">Importálás</button>
	</div>
</ng-template>

<ng-template #saveSuccess let-c="close" let-d="dismiss">
	<div class="modal-header">
		<h4 class="modal-title">Sikeres mentés</h4>
		<button type="button" class="close" aria-label="Close" (click)="d()">
			<span aria-hidden="true">&times;</span>
		</button>
	</div>
	<div class="modal-body">
		<div class="input-group">
			<span class="input-group-addon" placement="right" ngbTooltip="A mappa, ahova a kivágott mérési fájl mentve lesz">Mentési mappa</span>
			<input type="text" disabled class="form-control" name="saveFolderName" [(ngModel)]="saveFolderName" placement="bottom" ngbTooltip="{{ saveFolderName }}">
			<span class="input-group-btn">
				<button class="btn btn-secondary" type="button" (click)="saveShowFolder()">Mappa megnyitása</button>
			</span>
		</div>
		<table class="table">
			<thead>
				<tr>
					<th>Tól-Ig</th>
					<th>Fájlnév</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>0 mp - {{ mergeLen }} mp</td>
					<td><span placement="bottom" ngbTooltip="Kattintás a megtekintéshez">{{ saveFileName }}</span> <button class="btn btn-secondary" (click)="saveShowFile()">Megtekintés</button></td>
				</tr>
			</tbody>
		</table>
	</div>
	<div class="modal-footer">
		<button type="button" class="btn btn-primary" (click)="c()">Rendben</button>
	</div>
</ng-template>
